<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mos.domain.study.repository.StudyRepository">
  <resultMap id="studyList" type="StudyDto">
    <id column="study_no" property="studyNo"/>
    <result column="member_no" property="memberNo"/>
    <result column="title" property="title"/>
    <result column="intake" property="intake"/>
    <result column="method" property="method"/>
    <result column="recruitment_deadline" property="recruitmentDeadline"/>
  </resultMap>

  <resultMap id="studyDetail" type="studyDto">
    <id column="study_no" property="studyNo"/>
    <result column="member_no" property="memberNo"/>
    <result column="title" property="title"/>
    <result column="method" property="method"/>
    <result column="intake" property="intake"/>
    <result column="recruitment_deadline" property="recruitmentDeadline"/>
    <result column="end_date" property="endDate"/>
    <result column="introduction" property="introduction"/>
  </resultMap>

  <select id="findAll" resultMap="studyList">
    SELECT
      study_no,
      member_no,
      title,
      intake,
      method,
      recruitment_deadline
    FROM
      study
    ORDER BY
      study_no DESC
  </select>

  <select id="getByStudyNo" resultMap="studyDetail">
    SELECT
      study_no,
      member_no,
      title,
      method,
      intake,
      recruitment_deadline,
		  end_date,
		  introduction
    FROM
		  study
	  WHERE
		  study_no=#{studyNo};
  </select>

  <insert id="add" parameterType="StudyDto">
<!--  아직 유저 로그인을 구현/통합하지 않았으므로, 스터디장은 1번 유저를 대상으로 하도록 하드코딩하였음 -->
    INSERT INTO
      study(member_no, method, title, intake, recruitment_deadline, introduction)
    VALUES(1, #{method}, #{title}, #{intake}, #{recruitmentDeadline}, #{introduction})
  </insert>

</mapper>